"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{64106:function(e,n,r){r.d(n,{Z:function(){return H}});var t=r(34051),o=r.n(t),a=r(85893),i=r(50381),l=r(87536),u=r(14685),s=r(57818),c=r(38039),d=r(86721),m=r(8009),f=r(27856),v=r(66595),p=r(11163),b=r(70300),g=r(13480),h=r(95496),y=r(74231),x=y.Ry().shape({name:y.Z_().required("form:error-author-name-required")}),j=r(99868),w=r(58079),O=r(79544),S=r(13229),P=r(72950),N=r(82871);function Z(e,n,r,t,o,a,i){try{var l=e[a](i),u=l.value}catch(s){return void r(s)}l.done?n(u):Promise.resolve(u).then(t,o)}function k(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Q(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){k(e,n,r[n])}))}return e}var C=[{value:"FacebookIcon",label:"Facebook"},{value:"InstagramIcon",label:"Instagram"},{value:"TwitterIcon",label:"Twitter"},{value:"YouTubeIcon",label:"Youtube"}].map((function(e){return e.label=(0,a.jsxs)("div",{className:"flex items-center text-body space-s-4",children:[(0,a.jsx)("span",{className:"flex h-4 w-4 items-center justify-center",children:(0,w.q)({iconList:S,iconName:e.value,className:"w-4 h-4"})}),(0,a.jsx)("span",{children:e.label})]}),e}));function H(e){var n,r,t,y,w=e.initialValues,S=(0,p.useRouter)(),k=((0,p.useRouter)().locale,(0,b.$G)().t),H=S.query.shop,_=(0,P.DZ)({slug:H},{enabled:!!S.query.shop}).data,D=null===_||void 0===_?void 0:_.id,M=(0,l.cI)(Q({shouldUnregister:!0,resolver:(0,h.X)(x)},w&&{defaultValues:Q({},w,{socials:(null===w||void 0===w?void 0:w.socials)?null===w||void 0===w?void 0:w.socials.map((function(e){return{icon:null===C||void 0===C?void 0:C.find((function(n){return(null===n||void 0===n?void 0:n.value)===(null===e||void 0===e?void 0:e.icon)})),url:null===e||void 0===e?void 0:e.url}})):[],born:w.born?new Date(w.born):"",death:w.death?new Date(w.death):""})})),A=M.register,E=M.handleSubmit,R=M.control,q=M.setError,I=M.formState.errors,T=(0,N.bz)(),L=T.mutate,U=T.isLoading,$=(0,N.Oh)(),G=$.mutate,V=$.isLoading,F=(0,l.Dq)({control:R,name:"socials"}),B=F.fields,z=F.append,K=F.remove,J=function(){var e,n=(e=o().mark((function e(n){var r,t,a,i,l,u,s,c,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=Q({},n,{language:S.locale,socials:(null===n||void 0===n?void 0:n.socials)?null===n||void 0===n||null===(r=n.socials)||void 0===r?void 0:r.map((function(e){var n;return{icon:null===e||void 0===e||null===(n=e.icon)||void 0===n?void 0:n.value,url:null===e||void 0===e?void 0:e.url}})):[],image:{thumbnail:null===n||void 0===n||null===(t=n.image)||void 0===t?void 0:t.thumbnail,original:null===n||void 0===n||null===(a=n.image)||void 0===a?void 0:a.original,id:null===n||void 0===n||null===(i=n.image)||void 0===i?void 0:i.id},cover_image:{thumbnail:null===n||void 0===n||null===(l=n.image)||void 0===l?void 0:l.thumbnail,original:null===n||void 0===n||null===(u=n.image)||void 0===u?void 0:u.original,id:null===n||void 0===n||null===(s=n.image)||void 0===s?void 0:s.id}});try{w&&w.translated_languages.includes(S.locale)?G(Q({},c,{id:w.id,shop_id:D})):L(Q({},c,{shop_id:D},(null===w||void 0===w?void 0:w.slug)&&{slug:w.slug}))}catch(o){d=(0,m.e)(o),Object.keys(null===d||void 0===d?void 0:d.validation).forEach((function(e){q(e.split(".")[1],{type:"manual",message:null===d||void 0===d?void 0:d.validation[e][0]})}))}case 3:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function i(e){Z(a,t,o,i,l,"next",e)}function l(e){Z(a,t,o,i,l,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}();return(0,a.jsxs)("form",{onSubmit:E(J),children:[(0,a.jsxs)("div",{className:"my-5 flex flex-wrap border-b border-dashed border-border-base pb-8 sm:my-8",children:[(0,a.jsx)(f.Z,{title:k("form:input-label-image"),details:k("form:author-image-helper-text"),className:"w-full px-0 pb-5 sm:w-4/12 sm:py-8 sm:pe-4 md:w-1/3 md:pe-5"}),(0,a.jsx)(v.Z,{className:"w-full sm:w-8/12 md:w-2/3",children:(0,a.jsx)(g.Z,{name:"image",control:R,multiple:!1})})]}),(0,a.jsxs)("div",{className:"my-5 flex flex-wrap border-b border-dashed border-border-base pb-8 sm:my-8",children:[(0,a.jsx)(f.Z,{title:k("form:input-label-cover-image"),details:k("form:author-cover-image-helper-text"),className:"w-full px-0 pb-5 sm:w-4/12 sm:py-8 sm:pe-4 md:w-1/3 md:pe-5"}),(0,a.jsx)(v.Z,{className:"w-full sm:w-8/12 md:w-2/3",children:(0,a.jsx)(g.Z,{name:"cover_image",control:R,multiple:!1})})]}),(0,a.jsxs)("div",{className:"my-5 flex flex-wrap sm:my-8",children:[(0,a.jsx)(f.Z,{title:k("form:input-label-description"),details:"".concat(k(w?"form:item-description-edit":"form:item-description-add")," ").concat(k("form:author-form-description-details")),className:"w-full px-0 pb-5 sm:w-4/12 sm:py-8 sm:pe-4 md:w-1/3 md:pe-5 "}),(0,a.jsxs)(v.Z,{className:"w-full sm:w-8/12 md:w-2/3",children:[(0,a.jsx)(i.Z,Q({label:k("form:input-label-name")},A("name"),{error:k(null===(n=I.name)||void 0===n?void 0:n.message),variant:"outline",className:"mb-5"})),(0,a.jsx)(i.Z,Q({label:k("form:input-label-languages")},A("languages"),{error:k(null===(r=I.languages)||void 0===r?void 0:r.message),variant:"outline",className:"mb-5",placeholder:k("form:placeholder-add-languages-comma-separated")})),(0,a.jsx)(s.Z,Q({label:k("form:input-label-bio")},A("bio"),{variant:"outline",className:"mb-5"})),(0,a.jsx)(s.Z,Q({label:k("form:input-label-quote")},A("quote"),{variant:"outline",className:"mb-5"})),(0,a.jsxs)("div",{className:"mb-5 flex flex-col sm:flex-row",children:[(0,a.jsxs)("div",{className:"mb-5 w-full p-0 sm:mb-0 sm:w-1/2 sm:pe-2",children:[(0,a.jsx)(c.Z,{children:k("form:input-label-author-born")}),(0,a.jsx)(l.Qr,{control:R,name:"born",render:function(e){var n=e.field,r=n.onChange,t=n.onBlur,o=n.value;return(0,a.jsx)(d.M,{dateFormat:"dd/MM/yyyy",onChange:r,onBlur:t,selected:o,selectsStart:!0,startDate:new Date,className:"border border-border-base"})}}),(0,a.jsx)(j.Z,{message:k(null===(t=I.born)||void 0===t?void 0:t.message)})]}),(0,a.jsxs)("div",{className:"w-full p-0 sm:w-1/2 sm:ps-2",children:[(0,a.jsx)(c.Z,{children:k("form:input-label-author-death")}),(0,a.jsx)(l.Qr,{control:R,name:"death",render:function(e){var n=e.field,r=n.onChange,t=n.onBlur,o=n.value;return(0,a.jsx)(d.M,{dateFormat:"dd/MM/yyyy",onChange:r,onBlur:t,selected:o,selectsEnd:!0,startDate:new Date,className:"border border-border-base"})}}),(0,a.jsx)(j.Z,{message:k(null===(y=I.death)||void 0===y?void 0:y.message)})]})]}),(0,a.jsx)("div",{children:B.map((function(e,n){return(0,a.jsx)("div",{className:"border-b border-dashed border-border-200 py-5 first:mt-5 first:border-t last:border-b-0 md:py-8 md:first:mt-10",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-5",children:[(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)(c.Z,{children:k("form:input-label-select-platform")}),(0,a.jsx)(O.Z,{name:"socials.".concat(n,".icon"),control:R,options:C,isClearable:!0,defaultValue:null===e||void 0===e?void 0:e.icon})]}),(0,a.jsx)(i.Z,Q({className:"sm:col-span-2",label:k("form:input-label-social-url"),variant:"outline"},A("socials.".concat(n,".url")),{defaultValue:e.url})),(0,a.jsx)("button",{onClick:function(){K(n)},type:"button",className:"text-sm text-red-500 transition-colors duration-200 hover:text-red-700 focus:outline-none sm:col-span-1 sm:mt-4",children:k("form:button-label-remove")})]})},e.id)}))}),(0,a.jsx)(u.Z,{type:"button",onClick:function(){return z({icon:"",url:""})},className:"w-full sm:w-auto",children:k("form:button-label-add-social")})]})]}),(0,a.jsxs)("div",{className:"mb-4 text-end",children:[w&&(0,a.jsx)(u.Z,{variant:"outline",onClick:S.back,className:"me-4",type:"button",children:k("form:button-label-back")}),(0,a.jsx)(u.Z,{loading:V||U,children:k(w?"form:button-label-update-author":"form:button-label-add-author")})]})]})}},35279:function(e,n,r){var t=r(85893),o=r(96872),a=r(58079),i=r(48123),l=r(78126);n.Z=function(e){var n=e.href,r=e.icon,u=e.label,s=(0,l.l8)().closeSidebar;return(0,t.jsxs)(o.Z,{href:n,className:"text-start flex w-full items-center text-base text-body-dark focus:text-accent",children:[(0,a.q)({iconList:i,iconName:r,className:"w-5 h-5 me-4"}),(0,t.jsx)("span",{onClick:function(){return s()},children:u})]})}},86721:function(e,n,r){r.d(n,{M:function(){return o.a}});r(18698);var t=r(9198),o=r.n(t)},82871:function(e,n,r){r.d(n,{_H:function(){return O},MT:function(){return S},bz:function(){return x},KU:function(){return j},Oh:function(){return w}});var t=r(34051),o=r.n(t),a=r(11163),i=r(88767),l=r(40782),u=r(70300),s=r(90551),c=r(17785),d=r(66889),m=r(14511),f=r(14141);function v(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function p(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){v(e,n,r[n])}))}return e}function b(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var g=p({},(0,m.h)(c.P.AUTHORS),{paginated:function(e){var n=e.type,r=e.name,t=e.is_approved,o=b(e,["type","name","is_approved"]);return f.eN.get(c.P.AUTHORS,p({searchJoin:"and"},o,{search:f.eN.formatSearchParams({type:n,name:r,is_approved:t})}))}}),h=r(33206);function y(e,n,r,t,o,a,i){try{var l=e[a](i),u=l.value}catch(s){return void r(s)}l.done?n(u):Promise.resolve(u).then(t,o)}var x=function(){var e,n=(0,i.useQueryClient)(),r=(0,u.$G)().t,t=(0,a.useRouter)();return(0,i.useMutation)(g.create,{onSuccess:(e=o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query.shop?"/".concat(t.query.shop).concat(s.Z.author.list):s.Z.author.list,e.next=3,a.default.push(n,void 0,{locale:h.D.defaultLanguage});case 3:l.Am.success(r("common:successfully-created"));case 4:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function i(e){y(a,t,o,i,l,"next",e)}function l(e){y(a,t,o,i,l,"throw",e)}i(void 0)}))}),onSettled:function(){n.invalidateQueries(c.P.AUTHORS)}})},j=function(){var e=(0,i.useQueryClient)(),n=(0,u.$G)().t;return(0,i.useMutation)(g.delete,{onSuccess:function(){l.Am.success(n("common:successfully-deleted"))},onSettled:function(){e.invalidateQueries(c.P.AUTHORS)}})},w=function(){var e=(0,u.$G)().t,n=(0,i.useQueryClient)();return(0,i.useMutation)(g.update,{onSuccess:function(){l.Am.success(e("common:successfully-updated"))},onSettled:function(){n.invalidateQueries(c.P.AUTHORS)}})},O=function(e){var n=e.slug,r=e.language,t=(0,i.useQuery)([c.P.AUTHORS,{slug:n,language:r}],(function(){return g.get({slug:n,language:r})}));return{author:t.data,error:t.error,loading:t.isLoading}},S=function(e){var n,r=(0,i.useQuery)([c.P.AUTHORS,e],(function(e){var n=e.queryKey,r=e.pageParam;return g.paginated(Object.assign({},n[1],r))}),{keepPreviousData:!0}),t=r.data,o=r.error,a=r.isLoading;return{authors:null!==(n=null===t||void 0===t?void 0:t.data)&&void 0!==n?n:[],paginatorInfo:(0,d.Q)(t),error:o,loading:a}}},72950:function(e,n,r){r.d(n,{bg:function(){return b},TC:function(){return h},mj:function(){return g},DZ:function(){return x},uL:function(){return j},D9:function(){return y}});var t=r(70300),o=r(90551),a=r(88767),i=r(17785),l=r(40782),u=r(14141);function s(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function c(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){s(e,n,r[n])}))}return e}function d(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var m=c({},(0,r(14511).h)(i.P.SHOPS),{get:function(e){var n=e.slug;return u.eN.get("".concat(i.P.SHOPS,"/").concat(n))},paginated:function(e){var n=e.name,r=d(e,["name"]);return u.eN.get(i.P.SHOPS,c({searchJoin:"and"},r,{search:u.eN.formatSearchParams({name:n})}))},approve:function(e){return u.eN.post(i.P.APPROVE_SHOP,e)},disapprove:function(e){return u.eN.post(i.P.DISAPPROVE_SHOP,e)}}),f=r(66889),v=r(11163),p=r(6943),b=function(){var e=(0,t.$G)().t,n=(0,a.useQueryClient)();return(0,a.useMutation)(m.approve,{onSuccess:function(){l.Am.success(e("common:successfully-updated"))},onSettled:function(){n.invalidateQueries(i.P.SHOPS)}})},g=function(){var e=(0,t.$G)().t,n=(0,a.useQueryClient)();return(0,a.useMutation)(m.disapprove,{onSuccess:function(){l.Am.success(e("common:successfully-updated"))},onSettled:function(){n.invalidateQueries(i.P.SHOPS)}})},h=function(){var e=(0,a.useQueryClient)(),n=(0,v.useRouter)();return(0,a.useMutation)(m.create,{onSuccess:function(){var e=(0,p.WA)().permissions;if((0,p.Ft)(p.M$,e))return n.push(o.Z.adminMyShops);n.push(o.Z.dashboard)},onSettled:function(){e.invalidateQueries(i.P.SHOPS)}})},y=function(){var e=(0,t.$G)().t,n=(0,a.useQueryClient)();return(0,a.useMutation)(m.update,{onSuccess:function(){l.Am.success(e("common:successfully-updated"))},onSettled:function(){n.invalidateQueries(i.P.SHOPS)}})},x=function(e,n){var r=e.slug;return(0,a.useQuery)([i.P.SHOPS,{slug:r}],(function(){return m.get({slug:r})}),n)},j=function(e){var n,r=(0,a.useQuery)([i.P.SHOPS,e],(function(e){var n=e.queryKey,r=e.pageParam;return m.paginated(Object.assign({},n[1],r))}),{keepPreviousData:!0}),t=r.data,o=r.error,l=r.isLoading;return{shops:null!==(n=null===t||void 0===t?void 0:t.data)&&void 0!==n?n:[],paginatorInfo:(0,f.Q)(t),error:o,loading:l}}},8009:function(e,n,r){r.d(n,{e:function(){return a}});var t=r(11163),o=r(31955);function a(e){var n={message:"",validation:[]};if(e.graphQLErrors){var r=!0,a=!1,i=void 0;try{for(var l,u=e.graphQLErrors[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var s=l.value;if(s.extensions&&"validation"===s.extensions.category)return n.message=s.message,n.validation=s.extensions.validation,n;s.extensions&&"authorization"===s.extensions.category&&(o.Z.remove("auth_token"),o.Z.remove("auth_permissions"),t.default.push("/"))}}catch(c){a=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}return n.message=e.message,n}}}]);